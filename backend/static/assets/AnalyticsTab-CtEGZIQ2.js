import{j as e}from"./radixUI-MBKqlelr.js";import{i as te,a as h}from"./vendor-BQUE8CnD.js";import{C as r,b as o,c as x,a as c}from"./card-0UsC1Hfx.js";import{d as le,g as j,B as re}from"./index-BX3Jf5rY.js";import{B as n}from"./badge-DbL2e8Dt.js";import{T as ce,a as ie,b as g,c as v}from"./tabs-CTtBr4tg.js";import{P as b}from"./progress-CxTYqs7F.js";import{A as ne}from"./activity-C1A2Z62K.js";import{D as de}from"./download-DxzIzwbA.js";import{F as X}from"./file-text-lgpzM1Mh.js";import{B as Y}from"./building-D7pk8e3U.js";import{U as oe}from"./users-DJfJLhR6.js";import{T as xe}from"./trending-up-DZykrMLX.js";import{B as me}from"./bar-chart-3-B6uS4aOV.js";import{C as pe}from"./calendar-D-I7OBt9.js";import"./utils-Co3JUx4V.js";/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=le("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);function Se({userRole:Z,propertyId:_}){var D,T,C,E,S,B,k,L,U,M,I,F,$,H,z,J,V,q,G,K,Q,W;const m=te(),i=Z||(m==null?void 0:m.userRole)||"hr";_||(m==null||m.propertyId);const[s,y]=h.useState(null),[f,O]=h.useState(null),[l,A]=h.useState(null),[ee,w]=h.useState(!0),[R,P]=h.useState(!1);h.useEffect(()=>{se()},[]);const se=async()=>{try{if(w(!0),i==="hr"){const[a,t,p]=await Promise.all([j.get("/api/hr/analytics/overview"),j.get("/api/hr/analytics/property-performance"),j.get("/api/hr/analytics/employee-trends")]),N=a.data.data||a.data,u=t.data.data||t.data,d=p.data.data||p.data;y(N),O(u),A(d)}else{const[a,t]=await Promise.all([j.get("/api/manager/analytics/overview"),j.get("/api/manager/analytics/employee-trends")]),p=a.data.data||a.data,N=t.data.data||t.data;y(p),A(N)}}catch(a){console.error("Failed to fetch analytics data:",a)}finally{w(!1)}},ae=async()=>{try{P(!0);const a=i==="hr"?"/api/hr/analytics/export?format=json":"/api/manager/analytics/export?format=json",t=await j.get(a),p=JSON.stringify(t.data,null,2),N=new Blob([p],{type:"application/json"}),u=URL.createObjectURL(N),d=document.createElement("a");d.href=u,d.download=`analytics-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(u)}catch(a){console.error("Failed to export data:",a)}finally{P(!1)}};return ee?e.jsxs(r,{children:[e.jsx(o,{children:e.jsx(x,{children:"Analytics Dashboard"})}),e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ne,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading analytics data..."})]})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600",children:i==="hr"?"System metrics and performance insights":"Property metrics and performance insights"})]}),e.jsxs(re,{onClick:ae,disabled:R,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),R?"Exporting...":"Export Data"]})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(r,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Applications"}),e.jsx("p",{className:"text-2xl font-bold",children:((D=s==null?void 0:s.overview)==null?void 0:D.totalApplications)||0})]}),e.jsx(X,{className:"h-8 w-8 text-blue-500"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(n,{variant:"secondary",className:"text-xs",children:["+",((T=s==null?void 0:s.recentActivity)==null?void 0:T.newApplications)||0," this month"]})})]})}),e.jsx(r,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:i==="hr"?"Active Properties":"Pending Applications"}),e.jsx("p",{className:"text-2xl font-bold",children:i==="hr"?((C=s==null?void 0:s.overview)==null?void 0:C.totalProperties)||0:((E=s==null?void 0:s.overview)==null?void 0:E.pendingApplications)||0})]}),i==="hr"?e.jsx(Y,{className:"h-8 w-8 text-green-500"}):e.jsx(X,{className:"h-8 w-8 text-yellow-500"})]}),e.jsx("div",{className:"mt-2",children:e.jsx(n,{variant:"secondary",className:"text-xs",children:i==="hr"?`${((S=s==null?void 0:s.overview)==null?void 0:S.totalManagers)||0} managers`:"Awaiting review"})})]})}),e.jsx(r,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:((B=s==null?void 0:s.overview)==null?void 0:B.totalEmployees)||0})]}),e.jsx(oe,{className:"h-8 w-8 text-purple-500"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(n,{variant:"secondary",className:"text-xs",children:["+",((k=s==null?void 0:s.recentActivity)==null?void 0:k.newEmployees)||0," this month"]})})]})}),e.jsx(r,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Approval Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((L=s==null?void 0:s.overview)==null?void 0:L.totalApplications)>0?Math.round(((U=s==null?void 0:s.overview)==null?void 0:U.approvedApplications)/((M=s==null?void 0:s.overview)==null?void 0:M.totalApplications)*100):0,"%"]})]}),e.jsx(xe,{className:"h-8 w-8 text-orange-500"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(n,{variant:"secondary",className:"text-xs",children:[((I=s==null?void 0:s.overview)==null?void 0:I.approvedApplications)||0," approved"]})})]})})]}),e.jsxs(ce,{defaultValue:"applications",className:"space-y-6",children:[e.jsxs(ie,{className:`grid w-full ${i==="hr"?"grid-cols-3":"grid-cols-2"}`,children:[e.jsx(g,{value:"applications",children:"Application Trends"}),i==="hr"&&e.jsx(g,{value:"properties",children:"Property Performance"}),e.jsx(g,{value:"employees",children:"Employee Analytics"})]}),e.jsx(v,{value:"applications",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsx(o,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(he,{className:"h-5 w-5 mr-2"}),"Application Status Breakdown"]})}),e.jsx(c,{children:s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Pending"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{value:((F=s==null?void 0:s.applicationTrends)==null?void 0:F.pending)/((($=s==null?void 0:s.overview)==null?void 0:$.totalApplications)||1)*100,className:"w-24"}),e.jsx("span",{className:"text-sm font-medium",children:((H=s==null?void 0:s.applicationTrends)==null?void 0:H.pending)||0})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Approved"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{value:((z=s==null?void 0:s.applicationTrends)==null?void 0:z.approved)/(((J=s==null?void 0:s.overview)==null?void 0:J.totalApplications)||1)*100,className:"w-24"}),e.jsx("span",{className:"text-sm font-medium",children:((V=s==null?void 0:s.applicationTrends)==null?void 0:V.approved)||0})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Rejected"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{value:((q=s==null?void 0:s.applicationTrends)==null?void 0:q.rejected)/(((G=s==null?void 0:s.overview)==null?void 0:G.totalApplications)||1)*100,className:"w-24"}),e.jsx("span",{className:"text-sm font-medium",children:((K=s==null?void 0:s.applicationTrends)==null?void 0:K.rejected)||0})]})]})]})})]}),e.jsxs(r,{children:[e.jsx(o,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(me,{className:"h-5 w-5 mr-2"}),"Department Applications"]})}),e.jsx(c,{children:s&&e.jsx("div",{className:"space-y-3",children:Object.entries((s==null?void 0:s.departmentStats)||{}).map(([a,t])=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:a}),e.jsxs(n,{variant:"outline",children:[t.total," total"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-yellow-600 font-medium",children:t.pending}),e.jsx("div",{className:"text-gray-500",children:"Pending"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-green-600 font-medium",children:t.approved}),e.jsx("div",{className:"text-gray-500",children:"Approved"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 font-medium",children:t.rejected}),e.jsx("div",{className:"text-gray-500",children:"Rejected"})]})]})]},a))})})]})]})}),i==="hr"&&e.jsx(v,{value:"properties",children:e.jsxs(r,{children:[e.jsx(o,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 mr-2"}),"Property Performance Overview"]})}),e.jsx(c,{children:f&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Property"}),e.jsx("th",{className:"text-left p-2",children:"Location"}),e.jsx("th",{className:"text-center p-2",children:"Managers"}),e.jsx("th",{className:"text-center p-2",children:"Employees"}),e.jsx("th",{className:"text-center p-2",children:"Applications"}),e.jsx("th",{className:"text-center p-2",children:"Approval Rate"}),e.jsx("th",{className:"text-center p-2",children:"Recent Activity"})]})}),e.jsx("tbody",{children:(Q=f==null?void 0:f.propertyPerformance)==null?void 0:Q.map(a=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 font-medium",children:a.propertyName}),e.jsxs("td",{className:"p-2 text-gray-600",children:[a.city,", ",a.state]}),e.jsx("td",{className:"p-2 text-center",children:a.managersCount}),e.jsx("td",{className:"p-2 text-center",children:a.employeesCount}),e.jsx("td",{className:"p-2 text-center",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:a.totalApplications}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.pendingApplications,"P / ",a.approvedApplications,"A / ",a.rejectedApplications,"R"]})]})}),e.jsx("td",{className:"p-2 text-center",children:e.jsxs(n,{variant:a.approvalRate>=70?"default":a.approvalRate>=50?"secondary":"destructive",children:[a.approvalRate,"%"]})}),e.jsx("td",{className:"p-2 text-center",children:e.jsxs(n,{variant:"outline",children:[a.recentApplications," this week"]})})]},a.propertyId))})]})})})]})}),e.jsx(v,{value:"employees",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsx(o,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(pe,{className:"h-5 w-5 mr-2"}),"Monthly Hiring Trends"]})}),e.jsx(c,{children:l&&e.jsx("div",{className:"space-y-3",children:(W=l==null?void 0:l.monthlyTrends)==null?void 0:W.map(a=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"font-medium",children:a.month}),e.jsxs("div",{className:"flex space-x-4 text-sm",children:[e.jsxs("span",{className:"text-green-600",children:[a.newEmployees," hired"]}),e.jsxs("span",{className:"text-blue-600",children:[a.applications," applied"]})]})]},a.month))})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r,{children:[e.jsx(o,{children:e.jsx(x,{children:"Department Distribution"})}),e.jsx(c,{children:l&&e.jsx("div",{className:"space-y-2",children:Object.entries((l==null?void 0:l.departmentDistribution)||{}).map(([a,t])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:a}),e.jsx(n,{variant:"secondary",children:t})]},a))})})]}),e.jsxs(r,{children:[e.jsx(o,{children:e.jsx(x,{children:"Property Distribution"})}),e.jsx(c,{children:l&&e.jsx("div",{className:"space-y-2",children:Object.entries((l==null?void 0:l.propertyDistribution)||{}).map(([a,t])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:a}),e.jsx(n,{variant:"secondary",children:t})]},a))})})]})]})]})})]})]})}export{Se as AnalyticsTab};
